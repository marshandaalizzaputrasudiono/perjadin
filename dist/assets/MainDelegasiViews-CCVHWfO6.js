import{q as L,z as j,f as V,h,A as $,g as z,r as q,c as a,a as e,F as k,y as v,t as r,b as B,w as P,S as T,B as H,o,n as K,m as I,l as R,v as F,x as G}from"./index-Z_fhCoxB.js";import{_ as J}from"./ModalItem-E2e41U9R.js";import{T as S}from"./ToastAlert-Cfpk1Tx4.js";const U=e("h1",{class:"text-dark fw-bold mb-4"},"List Delegasi Pegawai",-1),Y=e("button",{"data-bs-toggle":"modal","data-bs-target":"#staticBackdrop",class:"btn btn-primary mb-4"}," Tambah Data ",-1),Q={class:"table-responsive"},W={class:"table table-striped table-bordered"},X=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"NO ST"),e("th",{scope:"col"},"NO SPPD"),e("th",{scope:"col"},"Jumlah Pegawai"),e("th",{scope:"col",class:"text-center"},"Status"),e("th",{scope:"col",class:"text-center"},"Action")])],-1),Z={key:0},ee=["textContent"],te={key:0},ae={key:1},oe={key:0},ne={key:1},se={class:"text-center"},le={key:0,class:"btn btn-primary"},ie={key:1,class:"btn btn-danger"},ce={class:"text-center"},re=["onClick"],de=["onClick"],ue=e("button",{class:"btn-sm btn-warning me-2 btn"},"Edit",-1),me={key:1},he={colspan:"5",class:"text-center"},_e={key:0,class:"list-group"},pe=["onClick"],be={key:0},ge=e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",class:"icon icon-tabler icons-tabler-filled icon-tabler-circle-check text-success"},[e("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),e("path",{d:"M17 3.34a10 10 0 1 1 -14.995 8.984l-.005 -.324l.005 -.324a10 10 0 0 1 14.995 -8.336zm-1.293 5.953a1 1 0 0 0 -1.32 -.083l-.094 .083l-3.293 3.292l-1.293 -1.292l-.094 -.083a1 1 0 0 0 -1.403 1.403l.083 .094l2 2l.094 .083a1 1 0 0 0 1.226 0l.094 -.083l4 -4l.083 -.094a1 1 0 0 0 -.083 -1.32z"})],-1),fe=[ge],ke={key:1,class:"text-center"},d="delegasiPegawai",ye={__name:"MainDelegasiViews",setup(ve){const w=L(),y=j(),l=V(),i=h([]),_=h(!0),b=h(""),g=h([]),D=$(()=>g.value.length?g.value.filter(n=>!i.value.some(s=>s.noST.noST===n.noST)).filter(n=>n.noST.toLowerCase().includes(b.value.toLowerCase())):[]),u=h(null);z(async()=>{console.log("onmounted delegasi"),g.value=await l.fetchData("suratTugas"),i.value=await l.fetchData(d),_.value=!_.value});const N=async n=>{if((await T.fire({title:`Hapus Data ${d}?`,icon:"question",showCancelButton:!0,confirmButtonText:"Ya",cancelButtonText:"Tidak",cancelButtonColor:"red"})).isConfirmed)try{await l.deleteItemById(d,n)?(S.fire({icon:"success",title:`Data ${d} berhasil dihapus`}),i.value=await l.fetchData(d)):S.fire({icon:"error",title:"Gagal menghapus data"})}catch(c){console.error("Error deleting item:",c),S.fire({icon:"error",title:"Terjadi kesalahan saat menghapus data"})}},M=n=>{u.value=n},O=async()=>{try{if(u.value==null)return T.fire({icon:"error",title:"Silahkan Pilih NO ST terlebih dahulu"});const n={noST:H(u.value)},s=await l.addItem("delegasiPegawai",n);y.manageIdDelegasi=s;const c=await T.fire({title:"NO ST berhasil dipilih",icon:"success",text:"Lanjutkan Penginputan Data",showCancelButton:!0,confirmButtonText:"Oke",cancelButtonText:"Nanti Aja",cancelButtonColor:"red",backdrop:!0,allowOutsideClick:!1,allowEscapeKey:!1}),t=document.getElementById("staticBackdrop"),m=window.bootstrap.Modal.getInstance(t);m&&await m.hide(),document.querySelectorAll(".modal-backdrop").forEach(p=>p.remove()),c.isConfirmed?await w.push({name:"manageDelegasi",params:{noST:u.value.noST}}):i.value=await l.fetchData(d),setTimeout(()=>{document.body.removeAttribute("style")},2e3)}catch(n){console.error("Terjadi kesalahan:",n)}},A=(n,s)=>{y.manageIdDelegasi=n,w.push({name:"manageDelegasi",params:{noST:s}})};return(n,s)=>{const c=q("router-link");return o(),a("div",null,[U,Y,e("div",Q,[e("table",W,[X,i.value.length>0?(o(),a("tbody",Z,[(o(!0),a(k,null,v(i.value,(t,m)=>{var p,x,C;return o(),a("tr",{key:m},[e("td",{textContent:r(t.noST.noST)},null,8,ee),e("td",null,[(p=t.relation)!=null&&p.length?(o(),a("div",te,[(o(!0),a(k,null,v(t.relation,(f,E)=>(o(),a("span",{class:K(["text-bg-dark py-2","badge fs-1 me-2"]),key:E},r(f.noSPPD.noSPPD),1))),128))])):(o(),a("div",ae,"Kosong"))]),e("td",null,[(x=t.relation)!=null&&x.length?(o(),a("span",oe,r(((C=t.relation)==null?void 0:C.length)+" Orang"),1)):(o(),a("span",ne,"Kosong"))]),e("td",se,[t.hasOwnProperty("relation")?(o(),a("button",le,"Aktif")):(o(),a("button",ie,"Non Aktif"))]),e("td",ce,[e("button",{onClick:f=>A(t.id,t.noST.noST),class:"btn-success btn me-2 btn-sm"}," Manage Data ",8,re),e("button",{class:"btn-danger btn me-2 btn-sm",onClick:f=>N(t.id)}," Hapus ",8,de),ue,B(c,{to:{name:"detailDelegasi",params:{noST:t.noST.noST}},class:"btn-sm btn-info btn"},{default:P(()=>[I("Detail")]),_:2},1032,["to"])])])}),128))])):(o(),a("tbody",me,[e("tr",null,[e("td",he,r(_.value?"Loading Data...":"Data masih kosong"),1)])]))])]),B(J,{title:"Pilih Nomor ST",confirmButtonText:"Simpan",actionType:"add",onConfirm:O},{body:P(()=>[R(e("input",{"onUpdate:modelValue":s[0]||(s[0]=t=>b.value=t),class:"form-control mb-3",type:"text",placeholder:"Cari ST..."},null,512),[[F,b.value]]),D.value.length?(o(),a("ul",_e,[(o(!0),a(k,null,v(D.value,t=>(o(),a("li",{key:t.id,class:"list-group-item d-flex justify-content-between align-items-center",onClick:m=>M(t),style:{cursor:"pointer"}},[I(r(t.noST)+" ",1),u.value===t?(o(),a("span",be,fe)):G("",!0)],8,pe))),128))])):(o(),a("div",ke,r(_.value?"Loading":"Data ST masih kosong"),1))]),_:1})])}}};export{ye as default};
