import{A as W,q as X,f as Z,h as u,g as aa,B as b,c as i,a,l as s,v as n,F as U,y as L,t as p,m,x,S as _,C as j,o as r}from"./index-DuWg9Xy8.js";import{T as ea}from"./ToastAlert-CYv91mmM.js";const ta={class:"card"},la=a("h4",{class:"card-header fw-bold text-dark"},"Form Pendelegasian Pegawai",-1),oa={class:"card-body"},sa={class:"accordion accordion-flush",id:"accordionFlushExample"},na={class:"accordion-item"},ia=a("h2",{class:"accordion-header"},[a("button",{class:"accordion-button px-0 bg-transparent text-dark fw-bold",type:"button","data-bs-toggle":"collapse","data-bs-target":"#flush-collapseOne","aria-expanded":"true","aria-controls":"flush-collapseOne"},[a("span",{class:"rounded-circle fs-1 text-bg-primary me-2 d-flex justify-content-center align-items-center",style:{width:"25px",height:"25px"}},"1"),m(" Pilih Nomor ST ")])],-1),ra={id:"flush-collapseOne",class:"accordion-collapse collapse show","data-bs-parent":"#accordionFlushExample"},ca={class:"accordion-body px-0"},ua={key:0,class:"list-group"},da=["onClick"],pa={key:0},ma=a("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",class:"icon icon-tabler icons-tabler-filled icon-tabler-circle-check text-success"},[a("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),a("path",{d:"M17 3.34a10 10 0 1 1 -14.995 8.984l-.005 -.324l.005 -.324a10 10 0 0 1 14.995 -8.336zm-1.293 5.953a1 1 0 0 0 -1.32 -.083l-.094 .083l-3.293 3.292l-1.293 -1.292l-.094 -.083a1 1 0 0 0 -1.403 1.403l.083 .094l2 2l.094 .083a1 1 0 0 0 1.226 0l.094 -.083l4 -4l.083 -.094a1 1 0 0 0 -.083 -1.32z"})],-1),ha=[ma],va={key:1,class:"text-center"},fa={class:"accordion-item"},ga=a("h2",{class:"accordion-header"},[a("button",{class:"accordion-button px-0 bg-transparent text-dark fw-bold collapsed",type:"button","data-bs-toggle":"collapse","data-bs-target":"#flush-collapseTwo","aria-expanded":"false","aria-controls":"flush-collapseTwo"},[a("span",{class:"rounded-circle fs-1 text-bg-primary me-2 d-flex justify-content-center align-items-center",style:{width:"25px",height:"25px"}},"2"),m(" Pilih Nomor SPPD "),a("sup",{class:"text-info ms-1"},"*Opsional")])],-1),ba={id:"flush-collapseTwo",class:"accordion-collapse collapse","data-bs-parent":"#accordionFlushExample"},_a={class:"accordion-body px-0"},ya={key:0,class:"list-group"},ka=["onClick"],xa={key:0},Pa=a("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",class:"icon icon-tabler icons-tabler-filled icon-tabler-circle-check text-success"},[a("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),a("path",{d:"M17 3.34a10 10 0 1 1 -14.995 8.984l-.005 -.324l.005 -.324a10 10 0 0 1 14.995 -8.336zm-1.293 5.953a1 1 0 0 0 -1.32 -.083l-.094 .083l-3.293 3.292l-1.293 -1.292l-.094 -.083a1 1 0 0 0 -1.403 1.403l.083 .094l2 2l.094 .083a1 1 0 0 0 1.226 0l.094 -.083l4 -4l.083 -.094a1 1 0 0 0 -.083 -1.32z"})],-1),wa=[Pa],Da={key:1,class:"text-center"},Ta={class:"accordion-item"},Sa=a("h2",{class:"accordion-header"},[a("button",{class:"accordion-button px-0 bg-transparent text-dark fw-bold collapsed",type:"button","data-bs-toggle":"collapse","data-bs-target":"#flush-collapseThree","aria-expanded":"false","aria-controls":"flush-collapseThree"},[a("span",{class:"rounded-circle fs-1 text-bg-primary me-2 d-flex justify-content-center align-items-center",style:{width:"25px",height:"25px"}},"3"),m(" Pilih Pegawai ")])],-1),Va={id:"flush-collapseThree",class:"accordion-collapse collapse","data-bs-parent":"#accordionFlushExample"},Ba={class:"accordion-body px-0"},Ca={key:0,class:"list-group"},Na=["onClick"],Ra={key:0},Ma=a("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",class:"icon icon-tabler icons-tabler-filled icon-tabler-circle-check text-success"},[a("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),a("path",{d:"M17 3.34a10 10 0 1 1 -14.995 8.984l-.005 -.324l.005 -.324a10 10 0 0 1 14.995 -8.336zm-1.293 5.953a1 1 0 0 0 -1.32 -.083l-.094 .083l-3.293 3.292l-1.293 -1.292l-.094 -.083a1 1 0 0 0 -1.403 1.403l.083 .094l2 2l.094 .083a1 1 0 0 0 1.226 0l.094 -.083l4 -4l.083 -.094a1 1 0 0 0 -.083 -1.32z"})],-1),Ua=[Ma],La={key:1,class:"text-center"},ja={key:0,class:"card mt-4",ref:"reviewSection"},Ha=a("h4",{class:"card-header fw-bold text-dark"},"Review Pilihan",-1),Ia={class:"card-body"},Ea=a("strong",null,"NO ST",-1),za=a("strong",null,"NO SPPD",-1),Aa=a("strong",null,"Nama Pegawai",-1),Ja={class:"mt-4"},Oa=a("h5",{class:"mb-3"},"Input Biaya Sarana dan Prasarana",-1),Fa={class:"card mb-3"},Ka=a("div",{class:"card-header"},"Hotel/Penginapan",-1),$a={class:"card-body"},qa={class:"mb-3"},Ya=a("label",{for:"hotelName",class:"form-label"},"Nama Hotel/Penginapan",-1),Ga={class:"mb-3"},Qa=a("label",{for:"hotelVoucher",class:"form-label"},"No Voucher/Invoice Hotel",-1),Wa={class:"card mb-3"},Xa=a("div",{class:"card-header"},"Transportasi",-1),Za={class:"card-body"},ae={class:"mb-3"},ee=a("label",{for:"transportationType",class:"form-label"},"Jenis Transportasi",-1),te={class:"mb-3"},le=a("label",{for:"bookingCode",class:"form-label"},"Kode Booking",-1),oe={class:"mb-3"},se=a("label",{for:"seatNumber",class:"form-label"},"Nomor Kursi",-1),ne={class:"mb-3"},ie=a("label",{for:"pricePP",class:"form-label"},"Harga PP",-1),re={class:"mb-3"},ce=a("label",{for:"priceDeparture",class:"form-label"},"Harga Tiket Berangkat",-1),ue={class:"mb-3"},de=a("label",{for:"priceReturn",class:"form-label"},"Harga Tiket Pulang",-1),pe={class:"mb-3"},me=a("label",{for:"sumTransport",class:"form-label"},"Jumlah Uang Transport",-1),he={class:"card mb-3"},ve=a("div",{class:"card-header"},"Penginapan",-1),fe={class:"card-body"},ge={class:"mb-3"},be=a("label",{for:"rate",class:"form-label"},"Tarif Satuan Penginapan",-1),_e={class:"mb-3"},ye=a("label",{for:"numDays",class:"form-label"},"Jumlah Hari/Malam",-1),ke={class:"mb-3"},xe=a("label",{for:"totalAccommodation",class:"form-label"},"Jumlah Harga Penginapan",-1),Pe={class:"card mb-3"},we=a("div",{class:"card-header"},"Uang Harian",-1),De={class:"card-body"},Te={class:"mb-3"},Se=a("label",{for:"dailyRate",class:"form-label"},"Satuan Uang Harian (Rp)",-1),Ve={class:"mb-3"},Be=a("label",{for:"dailyNumDays",class:"form-label"},"Jumlah Hari",-1),Ce={class:"mb-3"},Ne=a("label",{for:"totalDaily",class:"form-label"},"Total Uang Harian",-1),Re={class:"card mb-3"},Me=a("div",{class:"card-header"},"Biaya Lainnya (bila ada)",-1),Ue={class:"card-body"},Le={class:"mb-3"},je=a("label",{for:"uraian",class:"form-label"},"Keterangan",-1),He={class:"mb-3"},Ie=a("label",{for:"dailyNumDays",class:"form-label"},"Jumlah",-1),Je={__name:"AddDelegasiViews",setup(Ee){const{proxy:c}=W(),J=X(),y=Z(),P=u([]),w=u([]),D=u([]),T=u([]),v=u(!0);aa(async()=>{try{P.value=await y.fetchData("suratTugas"),w.value=await y.fetchData("sppd"),D.value=await y.fetchData("pegawai"),T.value=await y.fetchData("delegasiPegawai"),v.value=!v.value}catch(o){console.error("Error fetching data from IDB:",o),v.value=!v.value}});const S=u(""),V=u(""),B=u(""),g=u(null),f=u([]),h=u([]),H=b(()=>P.value.length?P.value.filter(o=>!T.value.some(t=>t.noST.noST===o.noST)).filter(o=>o.noST.toLowerCase().includes(S.value.toLowerCase())):[]),I=b(()=>w.value.length?w.value.filter(o=>!T.value.some(t=>t.noSPPD.some(e=>e.noSPPD===o.noSPPD))).filter(o=>o.noSPPD.toLowerCase().includes(V.value.toLowerCase())):[]),E=b(()=>D.value.length?D.value.filter(o=>o.namaPegawai.toLowerCase().includes(B.value.toLowerCase())):[]),O=o=>{g.value=o},F=o=>{const t=f.value.indexOf(o);t>-1?f.value.splice(t,1):f.value.push(o)},K=o=>{const t=h.value.indexOf(o);t>-1?h.value.splice(t,1):h.value.push(o)},l=u({hotelName:"",hotelVoucher:"",transportationType:"",bookingCode:"",seatNumber:"",pricePP:0,priceDeparture:0,priceReturn:0,totalPrice:0,rate:0,numDays:0,totalAccommodation:0,dailyRate:0,dailyNumDays:0,totalDaily:0,biayaLainnyaKeterangan:"",biayaLainnyaJumlah:0}),k=u(null),$=()=>{k.value.style.height="auto",k.value.style.height=`${k.value.scrollHeight}px`},q=async()=>{try{if(!(await _.fire({title:"Apakah data sudah betul?",icon:"question",showCancelButton:!0,confirmButtonText:"Ya",cancelButtonText:"Tidak",cancelButtonColor:"red"})).isConfirmed)return;const t=await Y();if(t){const e=c.unformatRupiah(t);Q();let M={...{totalSemuaDana:e,...l.value},noST:j(g.value),noSPPD:f.value.map(j),pegawai:h.value.map(j)};const A=await G();A&&(M={...M,...A}),await y.addItem("delegasiPegawai",M),ea.fire({icon:"success",title:"Data Delegasi Berhasil dibuat "}),J.push({name:"delegasi"})}}catch(o){console.error("Terjadi kesalahan:",o)}},Y=async()=>{const{value:o}=await _.fire({title:"Total Dana Yang Diterima",input:"text",inputValue:c.formatRupiah(0),inputValidator:t=>{if(!t)return"Input tidak boleh kosong";if(isNaN(c.unformatRupiah(t)))return"Input harus berupa angka"},showCancelButton:!0,confirmButtonText:"Lanjut",cancelButtonText:"Batal",cancelButtonColor:"red",didOpen:()=>{_.getInput().addEventListener("input",e=>{const d=e.target.value.replace(/[^0-9,]/g,"");e.target.value=c.formatRupiah(c.unformatRupiah(d))})}});return o},G=async()=>{const{value:o}=await _.fire({title:"Informasi Lanjuttan!",html:`
      <input id="input1" class="swal2-input" type="text" placeholder="Jumlah Pengembalian">
      <input id="input2" class="swal2-input" type="text" placeholder="Nomor Billing">
      <input id="input3" class="swal2-input" type="text" placeholder="NTPN">
    `,focusConfirm:!1,preConfirm:()=>{const t=document.getElementById("input1").value,e=document.getElementById("input2").value,d=document.getElementById("input3").value;return!t||!e||!d?(_.showValidationMessage("Semua bidang harus diisi!"),!1):isNaN(c.unformatRupiah(t))?(_.showValidationMessage("Jumlah Kembalian harus berisikan angka !"),!1):{jumlahPengembalian:t,nomorBilling:e,ntpn:d}},showCancelButton:!0,confirmButtonText:"Simpan",cancelButtonText:"Lewati Saja",didOpen:()=>{document.getElementById("input1").addEventListener("input",e=>{const d=e.target.value.replace(/[^0-9,]/g,"");e.target.value=c.formatRupiah(c.unformatRupiah(d))})}});return o};function z(o,t,e){const d=t*e;return c.formatRupiah(d)}const C=b(()=>{const o=l.value.pricePP+l.value.priceDeparture+l.value.priceReturn;return c.formatRupiah(o)}),N=b(()=>z(l.value.totalAccommodation,l.value.rate,l.value.numDays)),R=b(()=>z(l.value.totalDaily,l.value.dailyRate,l.value.dailyNumDays));function Q(){l.value.totalPrice=c.unformatRupiah(C.value),l.value.totalAccommodation=c.unformatRupiah(N.value),l.value.totalDaily=c.unformatRupiah(R.value)}return(o,t)=>(r(),i("div",null,[a("div",ta,[la,a("div",oa,[a("div",sa,[a("div",na,[ia,a("div",ra,[a("div",ca,[s(a("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>S.value=e),class:"form-control mb-3",type:"text",placeholder:"Cari ST..."},null,512),[[n,S.value]]),H.value.length?(r(),i("ul",ua,[(r(!0),i(U,null,L(H.value,e=>(r(),i("li",{key:e.id,class:"list-group-item d-flex justify-content-between align-items-center",onClick:d=>O(e),style:{cursor:"pointer"}},[m(p(e.noST)+" ",1),g.value===e?(r(),i("span",pa,ha)):x("",!0)],8,da))),128))])):(r(),i("div",va,p(v.value?"Loading":"Data ST masih kosong"),1))])])]),a("div",fa,[ga,a("div",ba,[a("div",_a,[s(a("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>V.value=e),class:"form-control mb-3",type:"text",placeholder:"Cari SPPD..."},null,512),[[n,V.value]]),I.value.length?(r(),i("ul",ya,[(r(!0),i(U,null,L(I.value,e=>(r(),i("li",{key:e.id,class:"list-group-item d-flex justify-content-between align-items-center",onClick:d=>F(e),style:{cursor:"pointer"}},[m(p(e.noSPPD)+" ",1),f.value.includes(e)?(r(),i("span",xa,wa)):x("",!0)],8,ka))),128))])):(r(),i("div",Da,p(v.value?"Loading":"Data SPPD masih kosong"),1))])])]),a("div",Ta,[Sa,a("div",Va,[a("div",Ba,[s(a("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>B.value=e),class:"form-control mb-3",type:"text",placeholder:"Cari Pegawai..."},null,512),[[n,B.value]]),E.value.length?(r(),i("ul",Ca,[(r(!0),i(U,null,L(E.value,e=>(r(),i("li",{key:e.id,class:"list-group-item d-flex justify-content-between align-items-center",onClick:d=>K(e),style:{cursor:"pointer"}},[m(p(e.namaPegawai)+" ",1),h.value.includes(e)?(r(),i("span",Ra,Ua)):x("",!0)],8,Na))),128))])):(r(),i("div",La,p(v.value?"Loading":"Data Pegawai masih kosong"),1))])])])])])]),g.value&&h.value.length?(r(),i("div",ja,[Ha,a("div",Ia,[a("p",null,[Ea,m(" : "+p(g.value?g.value.noST:"Belum ada"),1)]),a("p",null,[za,m(" : "+p(f.value.length?f.value.map(e=>e.noSPPD).join(", "):"Belum ada"),1)]),a("p",null,[Aa,m(" : "+p(h.value.length?h.value.map(e=>e.namaPegawai).join(", "):"Belum ada"),1)]),a("div",Ja,[Oa,a("div",Fa,[Ka,a("div",$a,[a("div",qa,[Ya,s(a("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>l.value.hotelName=e),type:"text",class:"form-control",id:"hotelName",placeholder:"Masukkan nama hotel/penginapan"},null,512),[[n,l.value.hotelName]])]),a("div",Ga,[Qa,s(a("input",{"onUpdate:modelValue":t[4]||(t[4]=e=>l.value.hotelVoucher=e),type:"text",class:"form-control",id:"hotelVoucher",placeholder:"Masukkan no voucher/invoice hotel"},null,512),[[n,l.value.hotelVoucher]])])])]),a("div",Wa,[Xa,a("div",Za,[a("div",ae,[ee,s(a("input",{"onUpdate:modelValue":t[5]||(t[5]=e=>l.value.transportationType=e),type:"text",class:"form-control",id:"transportationType",placeholder:"Masukkan jenis transportasi"},null,512),[[n,l.value.transportationType]])]),a("div",te,[le,s(a("input",{"onUpdate:modelValue":t[6]||(t[6]=e=>l.value.bookingCode=e),type:"text",class:"form-control",id:"bookingCode",placeholder:"Masukkan kode booking"},null,512),[[n,l.value.bookingCode]])]),a("div",oe,[se,s(a("input",{"onUpdate:modelValue":t[7]||(t[7]=e=>l.value.seatNumber=e),type:"text",class:"form-control",id:"seatNumber",placeholder:"Masukkan nomor kursi"},null,512),[[n,l.value.seatNumber]])]),a("div",ne,[ie,s(a("input",{"onUpdate:modelValue":t[8]||(t[8]=e=>l.value.pricePP=e),type:"number",class:"form-control",id:"pricePP",placeholder:"Masukkan harga PP"},null,512),[[n,l.value.pricePP]])]),a("div",re,[ce,s(a("input",{"onUpdate:modelValue":t[9]||(t[9]=e=>l.value.priceDeparture=e),type:"number",class:"form-control",id:"priceDeparture",placeholder:"Masukkan harga tiket berangkat"},null,512),[[n,l.value.priceDeparture]])]),a("div",ue,[de,s(a("input",{"onUpdate:modelValue":t[10]||(t[10]=e=>l.value.priceReturn=e),type:"number",class:"form-control",id:"priceReturn",placeholder:"Masukkan harga tiket pulang"},null,512),[[n,l.value.priceReturn]])]),a("div",pe,[me,s(a("input",{"onUpdate:modelValue":t[11]||(t[11]=e=>C.value=e),type:"text",class:"form-control",id:"sumTransport",readonly:""},null,512),[[n,C.value]])])])]),a("div",he,[ve,a("div",fe,[a("div",ge,[be,s(a("input",{"onUpdate:modelValue":t[12]||(t[12]=e=>l.value.rate=e),type:"number",class:"form-control",id:"rate",placeholder:"Masukkan tarif satuan penginapan"},null,512),[[n,l.value.rate]])]),a("div",_e,[ye,s(a("input",{"onUpdate:modelValue":t[13]||(t[13]=e=>l.value.numDays=e),type:"number",class:"form-control",id:"numDays",placeholder:"Masukkan jumlah hari/malam"},null,512),[[n,l.value.numDays]])]),a("div",ke,[xe,s(a("input",{"onUpdate:modelValue":t[14]||(t[14]=e=>N.value=e),type:"text",class:"form-control",id:"totalAccommodation",readonly:"",placeholder:"Masukkan jumlah harga penginapan"},null,512),[[n,N.value]])])])]),a("div",Pe,[we,a("div",De,[a("div",Te,[Se,s(a("input",{"onUpdate:modelValue":t[15]||(t[15]=e=>l.value.dailyRate=e),type:"number",class:"form-control",id:"dailyRate",placeholder:"Masukkan satuan uang harian"},null,512),[[n,l.value.dailyRate]])]),a("div",Ve,[Be,s(a("input",{"onUpdate:modelValue":t[16]||(t[16]=e=>l.value.dailyNumDays=e),type:"number",class:"form-control",id:"dailyNumDays",placeholder:"Masukkan jumlah hari"},null,512),[[n,l.value.dailyNumDays]])]),a("div",Ce,[Ne,s(a("input",{"onUpdate:modelValue":t[17]||(t[17]=e=>R.value=e),type:"text",class:"form-control",id:"totalDaily",readonly:"",placeholder:"Masukkan total uang harian"},null,512),[[n,R.value]])])])]),a("div",Re,[Me,a("div",Ue,[a("div",Le,[je,s(a("textarea",{id:"uraian","onUpdate:modelValue":t[18]||(t[18]=e=>l.value.biayaLainnyaKeterangan=e),class:"form-control",placeholder:"Isikan Keterangan Biaya Lainnya disini...",rows:"1",ref_key:"autoResizeTextarea",ref:k,onInput:$},null,544),[[n,l.value.biayaLainnyaKeterangan]])]),a("div",He,[Ie,s(a("input",{"onUpdate:modelValue":t[19]||(t[19]=e=>l.value.biayaLainnyaJumlah=e),type:"number",class:"form-control",id:"dailyNumDays",placeholder:"Masukkan jumlah hari"},null,512),[[n,l.value.biayaLainnyaJumlah]])])])]),a("button",{type:"button",onClick:q,class:"btn-save mt-3"},"Save")])])],512)):x("",!0)]))}};export{Je as default};
