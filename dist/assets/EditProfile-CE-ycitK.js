import{g as w,k as S,e as y,f as o,l as x,h as U,r as L,c as m,a as e,d as B,t as M,m as N,i as C,v as D,b as V,w as j,o as v,j as F}from"./index-BonIV0Ba.js";import{S as f}from"./sweetalert2.all-Bzy4Dz1f.js";const P={class:"card"},E=e("h4",{class:"card-header text-dark fw-bold"},"Edit Profile",-1),R={class:"card-body"},A={class:"row g-4 align-items-center"},I={class:"col-md-3 col-4"},T=["src"],z={key:0,class:"text-danger fs-3"},O={class:"col-md-9 col-8"},W=e("label",{for:"formFile",class:"form-label"},"Pilih Foto",-1),q={class:"col-12"},G=e("label",{for:"namaLengkap",class:"form-label"},"Nama Lengkap",-1),H={class:"d-flex justify-content-end mt-4"},J=["disabled"],Y={__name:"EditProfile",setup(K){const _=w(),p=S(),c=y(),i=o({}),r=o(null),s=o(null),t=o(null),u=o(!0),n=o(null),d=o(null),h=l=>{n.value=null;const a=l.target.files[0];if(a&&a.type.startsWith("image/")){if(a.size>2*1024*1024)return n.value="Ukuran file terlalu besar. Maksimal 2MB.",s.value=r.value,l.target.value=null;n.value=null,s.value=URL.createObjectURL(a),d.value=a}else s.value=r.value};x([s,t],()=>{if(s.value==r.value&&t.value==i.value.name)return u.value=!0;u.value=!1});const b=async()=>{if(t.value=="")return t.value=i.value.name,f.fire({icon:"error",title:"Nama Lengkap tidak boleh kosong"});const l={file:d.value,name:t.value},a=await c.updateData("users","username",i.value.username,l);delete a.file,c.updateUserLocalStorage(a),f.fire({icon:"success",title:"Profile Anda berhasil di ubah"}),p.push("/profile")};return U(async()=>{const{row:l,avatar:a}=await _.getUser();i.value=l,r.value=a,s.value=a,t.value=l.name}),(l,a)=>{const g=L("router-link");return v(),m("div",P,[E,e("div",R,[e("form",{onSubmit:B(b,["prevent"])},[e("div",A,[e("div",I,[e("img",{src:s.value,class:"card-img-top ratio ratio-1x1 object-fit-fill img-thumbnail"},null,8,T),n.value?(v(),m("p",z,M(n.value),1)):N("",!0)]),e("div",O,[e("div",null,[W,e("input",{onChange:h,accept:"image/*",class:"form-control",type:"file",id:"formFile"},null,32)])]),e("div",q,[e("div",null,[G,C(e("input",{type:"text","onUpdate:modelValue":a[0]||(a[0]=k=>t.value=k),class:"form-control",id:"namaLengkap"},null,512),[[D,t.value]])])])]),e("div",H,[V(g,{class:"btn btn-outline-primary me-3",to:"/profile"},{default:j(()=>[F("Back")]),_:1}),e("button",{type:"submit",class:"btn btn-warning",disabled:u.value},"Update",8,J)])],32)])])}}};export{Y as default};
