import{q as $,z,f as R,h,A as q,g as K,r as F,c as a,a as e,F as S,y as w,t as p,b as P,w as N,S as y,B as H,o,n as U,m as A,l as Y,v as G,x as J}from"./index-DYrpQ_Z4.js";import{_ as Q}from"./ModalItem-BY0QacqI.js";import{T as f}from"./ToastAlert-BqTsMoFM.js";const W=e("h1",{class:"text-dark fw-bold mb-4"},"List Delegasi Pegawai",-1),X=["disabled"],Z={class:"table-responsive"},tt={class:"table table-striped table-bordered"},et=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"NO ST"),e("th",{scope:"col"},"NO SPPD"),e("th",{scope:"col"},"Jumlah Pegawai"),e("th",{scope:"col",class:"text-center"},"Status"),e("th",{scope:"col",class:"text-center"},"Action")])],-1),at={key:0},ot=["textContent"],nt={key:0},st={key:1},lt={key:0},it={key:1},ct={class:"text-center"},rt={key:0,class:"btn btn-primary"},dt={key:1,class:"btn btn-danger"},ut={class:"text-center"},mt=["onClick"],ht=["onClick"],pt=["onClick"],gt={key:1},_t={colspan:"5",class:"text-center"},bt={key:0,class:"list-group"},ft=["onClick"],Tt={key:0},vt=e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",class:"icon icon-tabler icons-tabler-filled icon-tabler-circle-check text-success"},[e("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),e("path",{d:"M17 3.34a10 10 0 1 1 -14.995 8.984l-.005 -.324l.005 -.324a10 10 0 0 1 14.995 -8.336zm-1.293 5.953a1 1 0 0 0 -1.32 -.083l-.094 .083l-3.293 3.292l-1.293 -1.292l-.094 -.083a1 1 0 0 0 -1.403 1.403l.083 .094l2 2l.094 .083a1 1 0 0 0 1.226 0l.094 -.083l4 -4l.083 -.094a1 1 0 0 0 -.083 -1.32z"})],-1),kt=[vt],St={key:1,class:"text-center"},_="delegasiPegawai",Ct={__name:"MainDelegasiViews",setup(wt){const D=$(),x=z(),i=R(),c=h([]),g=h(!0),T=h(""),v=h([]),C=q(()=>v.value.length?v.value.filter(n=>!c.value.some(s=>s.noST.noST===n.noST)).filter(n=>n.noST.toLowerCase().includes(T.value.toLowerCase())):[]),l=h(null);K(async()=>{console.log("onmounted delegasi"),v.value=await i.fetchData("suratTugas"),c.value=await i.fetchData(_),g.value=!g.value});const M=async(n,s)=>{if((await y.fire({title:"Apakah Anda Yakin?",icon:"question",html:`No ST <strong>${s}</strong> akan di hapus`,showCancelButton:!0,confirmButtonText:"Ya",cancelButtonText:"Tidak",cancelButtonColor:"red"})).isConfirmed)try{await i.deleteItemById(_,n)?(f.fire({icon:"success",title:"Data Delegasi Pegawai berhasil dihapus"}),c.value=await i.fetchData(_)):f.fire({icon:"error",title:"Gagal menghapus data"})}catch(t){console.error("Error deleting item:",t),f.fire({icon:"error",title:"Terjadi kesalahan saat menghapus data"})}},E=n=>{console.log({st:n}),l.value=n,console.log(l.value)},I=async({actionType:n,data:s})=>{try{if(!l.value)return y.fire({icon:"error",title:"Silahkan Pilih NO ST terlebih dahulu"});const r={noST:H(l.value)};if(n==="add"){const m=await i.addItem("delegasiPegawai",r);x.manageIdDelegasi=m,(await y.fire({title:"NO ST berhasil dipilih",icon:"success",text:"Lanjutkan Penginputan Data",showCancelButton:!0,confirmButtonText:"Oke",cancelButtonText:"Nanti Aja",cancelButtonColor:"red",backdrop:!0,allowOutsideClick:!1,allowEscapeKey:!1})).isConfirmed?await D.push({name:"manageDelegasi",params:{noST:l.value.noST}}):c.value=await i.fetchData(_),setTimeout(()=>document.body.removeAttribute("style"),2e3)}else n==="edit"&&(await i.updateData("delegasiPegawai","id",s.id,r),c.value=await i.fetchData(_),f.fire({icon:"success",title:"NO ST berhasil diubah"}));const t=document.getElementById("staticBackdrop"),u=window.bootstrap.Modal.getInstance(t);u==null||u.hide(),document.querySelectorAll(".modal-backdrop").forEach(m=>m.remove())}catch(r){console.error("Terjadi kesalahan:",r)}},O=(n,s)=>{x.manageIdDelegasi=n,D.push({name:"manageDelegasi",params:{noST:s}})},L=()=>{l.value=null,d.value={title:"Pilih Nomor ST",confirmButtonText:"Simpan",actionType:"add",data:{}}},j=(n,s)=>{l.value=s,console.log(l.value),console.log(n),d.value={title:"Edit Data Pegawai",confirmButtonText:"Update",actionType:"edit",data:{id:n}}},d=h({title:"Tambah Data Pegawai",confirmButtonText:"Simpan",actionType:"add",data:{}});return(n,s)=>{const r=F("router-link");return o(),a("div",null,[W,e("button",{onClick:L,disabled:g.value,"data-bs-toggle":"modal","data-bs-target":"#staticBackdrop",class:"btn btn-primary mb-4"}," Tambah Data ",8,X),e("div",Z,[e("table",tt,[et,c.value.length>0?(o(),a("tbody",at,[(o(!0),a(S,null,w(c.value,(t,u)=>{var m,k,B;return o(),a("tr",{key:u},[e("td",{textContent:p(t.noST.noST)},null,8,ot),e("td",null,[(m=t.relation)!=null&&m.length?(o(),a("div",nt,[(o(!0),a(S,null,w(t.relation,(b,V)=>(o(),a("span",{class:U(["text-bg-dark py-2","badge fs-1 me-2"]),key:V},p(b.noSPPD.noSPPD),1))),128))])):(o(),a("div",st,"Kosong"))]),e("td",null,[(k=t.relation)!=null&&k.length?(o(),a("span",lt,p(((B=t.relation)==null?void 0:B.length)+" Orang"),1)):(o(),a("span",it,"Kosong"))]),e("td",ct,[t.relation.length?(o(),a("button",rt,"Aktif")):(o(),a("button",dt,"Non Aktif"))]),e("td",ut,[e("button",{onClick:b=>O(t.id,t.noST.noST),class:"btn-success btn me-2 btn-sm"}," Manage Data ",8,mt),e("button",{class:"btn-danger btn me-2 btn-sm",onClick:b=>M(t.id,t.noST.noST)}," Hapus ",8,ht),e("button",{"data-bs-toggle":"modal","data-bs-target":"#staticBackdrop",onClick:b=>j(t.id,t.noST),class:"btn-sm btn-warning me-2 btn"}," Edit ",8,pt),P(r,{to:{name:"detailDelegasi",params:{noST:t.noST.noST}},class:"btn-sm btn-info btn"},{default:N(()=>[A("Detail")]),_:2},1032,["to"])])])}),128))])):(o(),a("tbody",gt,[e("tr",null,[e("td",_t,p(g.value?"Loading Data...":"Data masih kosong"),1)])]))])]),P(Q,{title:d.value.title,confirmButtonText:d.value.confirmButtonText,actionType:d.value.actionType,data:d.value.data,onConfirm:I},{body:N(()=>[Y(e("input",{"onUpdate:modelValue":s[0]||(s[0]=t=>T.value=t),class:"form-control mb-3",type:"text",placeholder:"Cari ST..."},null,512),[[G,T.value]]),C.value.length?(o(),a("ul",bt,[(o(!0),a(S,null,w(C.value,t=>(o(),a("li",{key:t.id,class:"list-group-item d-flex justify-content-between align-items-center",onClick:u=>E(t),style:{cursor:"pointer"}},[A(p(t.noST)+" ",1),l.value===t?(o(),a("span",Tt,kt)):J("",!0)],8,ft))),128))])):(o(),a("div",St,p(g.value?"Loading":"Data ST masih kosong"),1))]),_:1},8,["title","confirmButtonText","actionType","data"])])}}};export{Ct as default};
