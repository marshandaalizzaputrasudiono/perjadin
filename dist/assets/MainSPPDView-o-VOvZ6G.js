import{f as V,h as p,g as L,c as v,a as t,F as E,y as N,t as i,b as U,w as F,o as h,l as g,v as m,e as y,d as H,p as O,j as $,S as q}from"./index-EwENnZnS.js";import{_ as A}from"./ModalItem-3Rk80Z1E.js";import{T as l}from"./ToastAlert-BK7j0J4s.js";import{_ as J}from"./_plugin-vue_export-helper-DlAUqK2U.js";const s=b=>(O("data-v-517bbf49"),b=b(),$(),b),G=s(()=>t("h1",{class:"text-dark fw-bold mb-4"},"List SPPD",-1)),K=["disabled"],Y={class:"table-responsive"},z={class:"table table-striped table-bordered"},Q=s(()=>t("thead",null,[t("tr",null,[t("th",{scope:"col"},"No SPPD"),t("th",{scope:"col"},"Tanggal SPPD"),t("th",{scope:"col"},"Tujuan"),t("th",{scope:"col"},"Tgl Berangkat"),t("th",{scope:"col"},"Tgl Pulang"),t("th",{scope:"col"},"Lama Penugasan"),t("th",{scope:"col",class:"text-center"},"Action")])],-1)),R={key:0},W=["textContent"],X=["textContent"],Z=["textContent"],tt=["textContent"],at=["textContent"],et=["textContent"],nt={class:"text-center"},lt=["onClick"],ot=["onClick"],st={key:1},it={colspan:"7",class:"text-center"},rt={class:"mb-3"},ut=s(()=>t("label",{for:"noSPPD",class:"form-label"},"Nomor SPPD",-1)),dt={class:"mb-3"},ct=s(()=>t("label",{for:"tgl",class:"form-label"},"Tanggal SPPD",-1)),gt=["min"],mt={class:"mb-3"},ft=s(()=>t("label",{for:"uraian",class:"form-label"},"Tujuan",-1)),Pt={class:"mb-3"},pt=s(()=>t("label",{for:"tglBerangkat",class:"form-label"},"Tanggal Keberangkatan",-1)),vt=["min"],ht={class:"mb-3"},bt=s(()=>t("label",{for:"tglPulang",class:"form-label"},"Tanggal Pulang",-1)),_t=["min","disabled"],Dt={class:"mb-3"},St=s(()=>t("label",{for:"lamaPenugasan",class:"form-label"},"Lama Penugasan (Hari)",-1)),f="sppd",kt={__name:"MainSPPDView",setup(b){const r=V(),a=p({noSPPD:"",tgl:"",tujuan:"",tglBerangkat:"",tglPulang:"",lamaPenugasan:""}),k=()=>{a.value={noSPPD:"",tgl:"",tujuan:"",tglBerangkat:"",tglPulang:"",lamaPenugasan:""}},x=()=>{k(),u.value={title:"Tambah Data SPPD",confirmButtonText:"Simpan",actionType:"add",data:a.value}},w=o=>{a.value={...o},u.value={title:"Edit Data SPPD",confirmButtonText:"Update",actionType:"edit",data:a.value}},u=p({title:"Tambah Data SPPD",confirmButtonText:"Simpan",actionType:"add",data:{}}),P=p([]),_=p(!0);L(async()=>{P.value=await r.fetchData(f),_.value=!_.value});const C=()=>a.value.noSPPD?a.value.tgl?a.value.tujuan.trim()?a.value.tglBerangkat?a.value.tglPulang?new Date(a.value.tglPulang)<=new Date(a.value.tglBerangkat)?(l.fire({icon:"error",title:"Tanggal pulang harus lebih besar dari tanggal keberangkatan"}),!1):a.value.lamaPenugasan?!0:(l.fire({icon:"error",title:"Lama penugasan harus diisi"}),!1):(l.fire({icon:"error",title:"Tanggal pulang harus diisi"}),!1):(l.fire({icon:"error",title:"Tanggal keberangkatan harus diisi"}),!1):(l.fire({icon:"error",title:"Tujuan harus diisi"}),!1):(l.fire({icon:"error",title:"Tanggal SPPD harus diisi"}),!1):(l.fire({icon:"error",title:"Nomor SPPD harus diisi"}),!1),T=async({actionType:o})=>{if(C())try{const n=JSON.parse(JSON.stringify(a.value));o==="add"?(await r.addItem(f,n),l.fire({icon:"success",title:"Data SPPD berhasil ditambahkan"})):o==="edit"&&(await r.updateData(f,"id",n.id,n),l.fire({icon:"success",title:"Data SPPD berhasil diubah"})),P.value=await r.fetchData(f),k();const e=document.getElementById("staticBackdrop"),c=window.bootstrap.Modal.getInstance(e);c&&c.hide();const D=document.querySelector(".modal-backdrop");D&&D.remove()}catch(n){console.error("Error:",n),l.fire({icon:"error",title:"Terjadi kesalahan"})}},I=async o=>{if((await q.fire({title:"Hapus Data SPPD?",icon:"question",showCancelButton:!0,confirmButtonText:"Ya",cancelButtonText:"Tidak",cancelButtonColor:"red"})).isConfirmed)try{await r.deleteItemById(f,o)?(l.fire({icon:"success",title:"Data SPPD berhasil dihapus"}),P.value=await r.fetchData(f)):l.fire({icon:"error",title:"Gagal menghapus data"})}catch(e){console.error("Error deleting item:",e),l.fire({icon:"error",title:"Terjadi kesalahan saat menghapus data"})}},j=()=>{a.value.tglBerangkat?(d.value=new Date(a.value.tglBerangkat),d.value.setDate(d.value.getDate()+1),d.value=d.value.toISOString().split("T")[0],a.value.tglPulang&&new Date(a.value.tglPulang)<=new Date(a.value.tglBerangkat)&&(a.value.tglPulang="",a.value.lamaPenugasan="")):(a.value.tglPulang="",a.value.lamaPenugasan="")},M=()=>{if(a.value.tglBerangkat&&a.value.tglPulang){const o=new Date(a.value.tglBerangkat),n=new Date(a.value.tglPulang),e=Math.abs(n-o),c=Math.ceil(e/(1e3*60*60*24));a.value.lamaPenugasan=c}else a.value.lamaPenugasan=""},S=o=>{if(!o)return"";const n={day:"numeric",month:"long",year:"numeric"};return new Date(o).toLocaleDateString("id-ID",n)},B=new Date().toISOString().split("T")[0],d=p("");return(o,n)=>(h(),v("div",null,[G,t("button",{class:"btn btn-primary mb-4",onClick:x,disabled:_.value,"data-bs-toggle":"modal","data-bs-target":"#staticBackdrop"}," Tambah Data ",8,K),t("div",Y,[t("table",z,[Q,P.value.length>0?(h(),v("tbody",R,[(h(!0),v(E,null,N(P.value,(e,c)=>(h(),v("tr",{key:c},[t("td",{textContent:i(e.noSPPD)},null,8,W),t("td",{textContent:i(S(e.tgl))},null,8,X),t("td",{textContent:i(e.tujuan)},null,8,Z),t("td",{textContent:i(S(e.tglBerangkat))},null,8,tt),t("td",{textContent:i(S(e.tglPulang))},null,8,at),t("td",{textContent:i(e.lamaPenugasan+" Hari")},null,8,et),t("td",nt,[t("button",{class:"btn-danger btn btn-sm",onClick:D=>I(e.id)},"Hapus",8,lt),t("button",{"data-bs-toggle":"modal","data-bs-target":"#staticBackdrop",class:"btn-sm btn-warning btn",onClick:D=>w(e)}," Edit ",8,ot)])]))),128))])):(h(),v("tbody",st,[t("tr",null,[t("td",it,i(_.value?"Loading Data...":"Data masih kosong"),1)])]))])]),U(A,{title:u.value.title,confirmButtonText:u.value.confirmButtonText,actionType:u.value.actionType,data:u.value.data,onConfirm:T},{body:F(()=>[t("form",{onSubmit:H(T,["prevent"])},[t("div",rt,[ut,g(t("input",{"onUpdate:modelValue":n[0]||(n[0]=e=>a.value.noSPPD=e),type:"text",class:"form-control",id:"noSPPD"},null,512),[[m,a.value.noSPPD]])]),t("div",dt,[ct,g(t("input",{"onUpdate:modelValue":n[1]||(n[1]=e=>a.value.tgl=e),type:"date",min:y(B),class:"form-control",id:"tgl"},null,8,gt),[[m,a.value.tgl]])]),t("div",mt,[ft,g(t("input",{id:"uraian","onUpdate:modelValue":n[2]||(n[2]=e=>a.value.tujuan=e),class:"form-control",type:"text"},null,512),[[m,a.value.tujuan]])]),t("div",Pt,[pt,g(t("input",{"onUpdate:modelValue":n[3]||(n[3]=e=>a.value.tglBerangkat=e),type:"date",min:y(B),class:"form-control",id:"tglBerangkat",onChange:j},null,40,vt),[[m,a.value.tglBerangkat]])]),t("div",ht,[bt,g(t("input",{"onUpdate:modelValue":n[4]||(n[4]=e=>a.value.tglPulang=e),type:"date",min:d.value,class:"form-control",id:"tglPulang",disabled:!a.value.tglBerangkat,onChange:M},null,40,_t),[[m,a.value.tglPulang]])]),t("div",Dt,[St,g(t("input",{"onUpdate:modelValue":n[5]||(n[5]=e=>a.value.lamaPenugasan=e),type:"text",class:"form-control",id:"lamaPenugasan",readonly:""},null,512),[[m,a.value.lamaPenugasan]])])],32)]),_:1},8,["title","confirmButtonText","actionType","data"])]))}},wt=J(kt,[["__scopeId","data-v-517bbf49"]]);export{wt as default};
