import{f as V,h as c,g as j,c as u,a as t,F,y as L,t as T,b as H,w as q,o as m,l as S,v as y,d as z,p as A,j as J,S as O}from"./index-Z_fhCoxB.js";import{_ as R}from"./ModalItem-E2e41U9R.js";import{T as s}from"./ToastAlert-Cfpk1Tx4.js";import{_ as Y}from"./_plugin-vue_export-helper-DlAUqK2U.js";const p=f=>(A("data-v-bfdaab3a"),f=f(),J(),f),G=p(()=>t("h1",{class:"text-dark fw-bold mb-4"},"List Surat Tugas",-1)),P=["disabled"],K={class:"table-responsive"},Q={class:"table table-striped table-bordered"},W=p(()=>t("thead",null,[t("tr",null,[t("th",{scope:"col"},"No ST"),t("th",{scope:"col"},"Tanggal ST"),t("th",{scope:"col"},"Uraian ST"),t("th",{scope:"col",class:"text-center"},"Action")])],-1)),X={key:0},Z=["textContent"],tt=["textContent"],at=["textContent"],et={class:"text-center"},ot=["onClick"],nt=["onClick"],st={key:1},rt={colspan:"6",class:"text-center"},it={class:"mb-3"},lt=p(()=>t("label",{for:"noST",class:"form-label"},"Nomor Surat Tugas",-1)),ct={class:"mb-3"},dt=p(()=>t("label",{for:"tgl",class:"form-label"},"Tanggal Surat Tugas",-1)),ut=["min"],mt={class:"mb-3"},pt=p(()=>t("label",{for:"uraian",class:"form-label"},"Uraian",-1)),r="suratTugas",ft={__name:"MainSTView",setup(f){const i=V(),o=c({noST:"",tgl:"",uraian:""}),d=c([]),h=c(!0);j(async()=>{console.log("onmounted surat tugas"),d.value=await i.fetchData(r),h.value=!h.value,k()});const w=()=>o.value.noST?o.value.tgl?o.value.uraian.trim()?!0:(s.fire({icon:"error",title:"Uraian harus diisi"}),!1):(s.fire({icon:"error",title:"Tanggal Surat Tugas harus diisi"}),!1):(s.fire({icon:"error",title:"Nomor Surat Tugas harus diisi"}),!1),x=async({actionType:n})=>{if(w())try{const e=JSON.parse(JSON.stringify(o.value));n==="add"?(await i.addItem(r,e),s.fire({icon:"success",title:"Data Surat Tugas berhasil ditambahkan"})):n==="edit"&&(await i.updateData(r,"id",e.id,e),s.fire({icon:"success",title:"Data Surat Tugas berhasil diubah"})),d.value=await i.fetchData(r),D();const a=document.getElementById("staticBackdrop"),b=window.bootstrap.Modal.getInstance(a);b&&b.hide();const _=document.querySelector(".modal-backdrop");_&&_.remove()}catch(e){console.error("Error:",e),s.fire({icon:"error",title:"Terjadi kesalahan"})}},D=()=>{o.value={noST:"",tgl:"",uraian:""}},B=async n=>{if((await O.fire({title:"Hapus Data Surat Tugas?",icon:"question",showCancelButton:!0,confirmButtonText:"Ya",cancelButtonText:"Tidak",cancelButtonColor:"red"})).isConfirmed)try{await i.deleteItemById(r,n)?(s.fire({icon:"success",title:`Data ${r} berhasil dihapus`}),d.value=await i.fetchData(r)):s.fire({icon:"error",title:"Gagal menghapus data"})}catch(a){console.error("Error deleting item:",a),s.fire({icon:"error",title:"Terjadi kesalahan saat menghapus data"})}},C=()=>{D(),l.value={title:"Tambah Data Surat Tugas",confirmButtonText:"Simpan",actionType:"add",data:o.value}},I=n=>{o.value={...n},l.value={title:"Edit Data Surat Tugas",confirmButtonText:"Update",actionType:"edit",data:o.value}},l=c({title:"Tambah Data Surat Tugas",confirmButtonText:"Simpan",actionType:"add",data:{}}),g=c(null),k=()=>{g.value.style.height="auto",g.value.style.height=`${g.value.scrollHeight}px`},v=new Date,M=v.getFullYear(),E=String(v.getMonth()+1).padStart(2,"0"),$=String(v.getDate()).padStart(2,"0"),N=c(`${M}-${E}-${$}`),U=n=>{if(!n)return"";const e={day:"numeric",month:"long",year:"numeric"};return new Date(n).toLocaleDateString("id-ID",e)};return(n,e)=>(m(),u("div",null,[G,t("button",{type:"button",class:"btn btn-primary mb-4",onClick:C,disabled:h.value,"data-bs-toggle":"modal","data-bs-target":"#staticBackdrop"}," Tambah Data ",8,P),t("div",K,[t("table",Q,[W,d.value.length>0?(m(),u("tbody",X,[(m(!0),u(F,null,L(d.value,(a,b)=>(m(),u("tr",{key:b},[t("td",{textContent:T(a.noST)},null,8,Z),t("td",{textContent:T(U(a.tgl))},null,8,tt),t("td",{textContent:T(a.uraian)},null,8,at),t("td",et,[t("button",{class:"btn-danger btn me-2 btn-sm",onClick:_=>B(a.id)},"Hapus",8,ot),t("button",{"data-bs-toggle":"modal","data-bs-target":"#staticBackdrop",class:"btn-sm btn-warning btn",onClick:_=>I(a)}," Edit ",8,nt)])]))),128))])):(m(),u("tbody",st,[t("tr",null,[t("td",rt,T(h.value?"Loading Data...":"Data masih kosong"),1)])]))])]),H(R,{title:l.value.title,confirmButtonText:l.value.confirmButtonText,actionType:l.value.actionType,data:l.value.data,onConfirm:x},{body:q(()=>[t("form",{onSubmit:z(x,["prevent"])},[t("div",it,[lt,S(t("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>o.value.noST=a),type:"text",class:"form-control",id:"noST"},null,512),[[y,o.value.noST]])]),t("div",ct,[dt,S(t("input",{"onUpdate:modelValue":e[1]||(e[1]=a=>o.value.tgl=a),type:"date",min:N.value,class:"form-control",id:"tgl"},null,8,ut),[[y,o.value.tgl]])]),t("div",mt,[pt,S(t("textarea",{id:"uraian","onUpdate:modelValue":e[2]||(e[2]=a=>o.value.uraian=a),class:"form-control",placeholder:"Isikan detail uraian penugasannya...",rows:"1",ref_key:"autoResizeTextarea",ref:g,onInput:k},null,544),[[y,o.value.uraian]])])],32)]),_:1},8,["title","confirmButtonText","actionType","data"])]))}},Tt=Y(ft,[["__scopeId","data-v-bfdaab3a"]]);export{Tt as default};
